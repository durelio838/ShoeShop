<Page x:Class="ShoeShop.ProductsPage"
      xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
      xmlns:local="clr-namespace:ShoeShop"
      Title="Products"
      Background="White"
      FontFamily="Times New Roman"
      FontSize="14">

	<Page.Resources>
		<local:DiscountBackgroundConverter x:Key="DiscBg"/>
		<local:StockToVisibilityConverter x:Key="StockVis"/>
		<local:DiscountToVisibilityConverter x:Key="DiscVis"/>
	</Page.Resources>

	<Grid Margin="8">
		<Grid.RowDefinitions>
			<RowDefinition Height="Auto"/>
			<RowDefinition Height="Auto"/>
			<RowDefinition Height="*"/>
			<RowDefinition Height="Auto"/>
		</Grid.RowDefinitions>

		<StackPanel x:Name="pnlFilter" Grid.Row="0" Orientation="Horizontal"
                    Margin="0,0,0,8" Visibility="Collapsed">
			<TextBlock Text="Search:" VerticalAlignment="Center" Margin="0,0,4,0"/>
			<TextBox x:Name="txtSearch" Width="150" Height="24" TextChanged="TxtSearch_Changed"/>

			<TextBlock Text="Sort:" VerticalAlignment="Center" Margin="10,0,4,0"/>
			<ComboBox x:Name="cmbSort" Width="120" Height="24" SelectionChanged="CmbSort_Changed">
				<ComboBoxItem Content="None" IsSelected="True"/>
				<ComboBoxItem Content="Price Up"/>
				<ComboBoxItem Content="Price Down"/>
			</ComboBox>

			<TextBlock Text="Category:" VerticalAlignment="Center" Margin="10,0,4,0"/>
			<ComboBox x:Name="cmbCat" Width="110" Height="24" SelectionChanged="CmbCat_Changed"/>
		</StackPanel>

		<StackPanel x:Name="pnlAdmin" Grid.Row="1" Orientation="Horizontal"
                    Margin="0,0,0,8" Visibility="Collapsed">
			<Button Content="Add" Click="BtnAdd_Click" Background="#00FA9A" Height="24"/>
		</StackPanel>

		<ListView x:Name="lvProducts" Grid.Row="2"
                  SelectionChanged="LvProducts_Changed"
                  ScrollViewer.HorizontalScrollBarVisibility="Disabled"
                  BorderThickness="0">
			<ListView.ItemTemplate>
				<DataTemplate>
					<Border Margin="2" Padding="6" BorderThickness="1" BorderBrush="#CCC"
                            Background="{Binding Discount, Converter={StaticResource DiscBg}}">
						<Grid>
							<Grid.ColumnDefinitions>
								<ColumnDefinition Width="90"/>
								<ColumnDefinition Width="*"/>
								<ColumnDefinition Width="120"/>
							</Grid.ColumnDefinitions>

							<Image Source="{Binding ImagePath}" Width="80" Height="80" Stretch="Uniform"/>

							<StackPanel Grid.Column="1" VerticalAlignment="Center" Margin="8,0">
								<TextBlock Text="{Binding ProductName}" FontWeight="Bold" FontSize="14"/>
								<TextBlock Text="{Binding Description}" TextWrapping="Wrap"
                                           MaxWidth="320" Foreground="#666" Margin="0,2"/>
								<StackPanel Orientation="Horizontal">
									<TextBlock Text="Article: " Foreground="#888"/>
									<TextBlock Text="{Binding Article}"/>
								</StackPanel>
								<StackPanel Orientation="Horizontal">
									<TextBlock Text="Manufacturer: " Foreground="#888"/>
									<TextBlock Text="{Binding Manufacturer.ManufacturerName}"/>
								</StackPanel>
								<TextBlock Text="OUT OF STOCK" Foreground="Red" FontWeight="Bold"
                                           Visibility="{Binding StockQuantity, Converter={StaticResource StockVis}}"/>
							</StackPanel>

							<StackPanel Grid.Column="2" VerticalAlignment="Center" HorizontalAlignment="Right">
								<StackPanel Orientation="Horizontal">
									<TextBlock Text="{Binding DiscountedPrice, StringFormat=N0}"
                                               FontSize="15" FontWeight="Bold"/>
									<TextBlock Text=" rub" FontSize="15" FontWeight="Bold"/>
								</StackPanel>
								<StackPanel Orientation="Horizontal"
                                            Visibility="{Binding Discount, Converter={StaticResource DiscVis}}">
									<TextBlock Text="{Binding Price, StringFormat=N0}"
                                               TextDecorations="Strikethrough" Foreground="#888"/>
									<TextBlock Text=" rub" Foreground="#888"/>
								</StackPanel>
								<StackPanel Orientation="Horizontal"
                                            Visibility="{Binding Discount, Converter={StaticResource DiscVis}}">
									<TextBlock Text="Discount " Foreground="Green"/>
									<TextBlock Text="{Binding Discount}" Foreground="Green"/>
									<TextBlock Text="%" Foreground="Green"/>
								</StackPanel>
							</StackPanel>
						</Grid>
					</Border>
				</DataTemplate>
			</ListView.ItemTemplate>
		</ListView>

		<StackPanel Grid.Row="3" Orientation="Horizontal" Margin="0,6,0,0">
			<TextBlock x:Name="txtCount" VerticalAlignment="Center"/>
			<Button x:Name="btnEdit" Content="Edit" Click="BtnEdit_Click"
                    Visibility="Collapsed" Margin="10,0,4,0" Height="22"/>
			<Button x:Name="btnDel" Content="Delete" Click="BtnDel_Click"
                    Visibility="Collapsed" Background="#FDD" Height="22"/>
		</StackPanel>
	</Grid>
</Page>